{"version":3,"sources":["webpack:///./src/components/utils/InputField.tsx","webpack:///./src/components/views/Instance/Config/InstanceSettings.tsx"],"names":["InputField","props","state","currentValue","defaultValue","random","Math","toString","changed","this","InputGroup","Prepend","className","Text","id","name","type","onChange","event","setState","target","selectedOptions","value","disabled","Object","values","enum","filter","val","isNaN","parseInt","map","possiblevalue","key","message","htmlFor","Form","Check","inline","custom","label","currentTarget","checked","FormControl","Fragment","Append","style","opacity","pointerEvents","onClick","fixedWidth","icon","React","Component","withRouter","loading","errors","error","prevState","Array","from","push","instance","response","InstanceClient","editInstance","code","StatusCode","OK","loadInstance","addError","_editInstance","Loading","text","checkIMFlag","flag","selfPermissionSet","instanceManagerRights","err","index","ErrorAlert","onClose","prev","newarr","undefined","newval","InstanceManagerRights","Rename","path","Relocate","chatBotLimit","SetChatBotLimit","autoUpdateInterval","SetAutoUpdate","ConfigurationType","configurationType","SetConfiguration"],"mappings":"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","file":"16.596548ebd899f3b371f7.js","sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React from \"react\";\nimport Form from \"react-bootstrap/Form\";\nimport FormControl from \"react-bootstrap/FormControl\";\nimport InputGroup from \"react-bootstrap/InputGroup\";\nimport { FormattedMessage } from \"react-intl\";\n\ninterface IState {\n    currentValue: string | boolean | number;\n}\n\ntype IProps = {\n    name: string;\n    disabled?: boolean;\n} & (\n    | {\n          name: string;\n          defaultValue: boolean;\n          onChange: (newvalue: boolean) => void;\n          type: \"bool\";\n      }\n    | {\n          name: string;\n          defaultValue: number;\n          onChange: (newvalue: number) => void;\n          type: \"num\";\n      }\n    | {\n          name: string;\n          defaultValue: string;\n          onChange: (newvalue: string) => void;\n          type: \"str\";\n      }\n    | {\n          name: string;\n          defaultValue: string | number;\n          onChange: (newvalue: string) => void;\n          type: \"enum\";\n          enum: Record<string, string | number>;\n      }\n);\n\nexport default class InputField extends React.Component<IProps, IState> {\n    public constructor(props: IProps) {\n        super(props);\n\n        this.state = {\n            currentValue: props.defaultValue\n        };\n    }\n\n    public render(): React.ReactNode {\n        const random = Math.random().toString();\n        const changed = this.state.currentValue !== this.props.defaultValue;\n\n        return (\n            <InputGroup>\n                <InputGroup.Prepend className=\"w-40 flex-grow-1 flex-xl-grow-0 overflow-auto mb-2 mb-xl-0\">\n                    <InputGroup.Text className={`flex-fill ${changed ? \"font-weight-bold\" : \"\"}`}>\n                        <FormattedMessage id={`fields.${this.props.name}`} />\n                    </InputGroup.Text>\n                </InputGroup.Prepend>\n                <div className=\"flex-grow-1 w-100 w-xl-auto d-flex mb-3 mb-xl-0\">\n                    {this.props.type === \"enum\" ? (\n                        <select\n                            className={`flex-fill mb-0 ${changed ? \"font-weight-bold\" : \"\"}`}\n                            onChange={event => {\n                                this.setState({\n                                    currentValue: event.target.selectedOptions[0].value\n                                });\n                            }}\n                            disabled={this.props.disabled}\n                            defaultValue={this.props.defaultValue}>\n                            {Object.values(this.props.enum)\n                                .filter(val => isNaN(parseInt(val as string)))\n                                .map(possiblevalue => (\n                                    <FormattedMessage\n                                        key={possiblevalue}\n                                        id={`fields.${this.props.name}.${possiblevalue}`}>\n                                        {message => (\n                                            <option value={possiblevalue}>{message}</option>\n                                        )}\n                                    </FormattedMessage>\n                                ))}\n                        </select>\n                    ) : this.props.type === \"bool\" ? (\n                        <label\n                            htmlFor={random}\n                            className=\"d-flex justify-content-center align-content-center flex-grow-1 w-100 w-xl-auto mb-0\">\n                            <Form.Check\n                                inline\n                                type=\"switch\"\n                                custom\n                                id={random}\n                                className=\"m-auto\"\n                                label=\"\"\n                                onChange={event => {\n                                    this.setState({\n                                        currentValue: event.currentTarget.checked\n                                    });\n                                }}\n                                checked={this.state.currentValue as boolean}\n                                disabled={this.props.disabled}\n                            />\n                        </label>\n                    ) : (\n                        <FormControl\n                            custom\n                            type={this.props.type === \"num\" ? \"number\" : \"text\"}\n                            className={`flex-fill mb-0 ${changed ? \"font-weight-bold\" : \"\"}`}\n                            onChange={event => {\n                                if (this.props.type == \"num\") {\n                                    this.setState({\n                                        currentValue: parseInt(event.currentTarget.value)\n                                    });\n                                } else {\n                                    this.setState({\n                                        currentValue: event.currentTarget.value\n                                    });\n                                }\n                            }}\n                            value={this.state.currentValue as string | number}\n                            disabled={this.props.disabled}\n                        />\n                    )}\n                    <React.Fragment>\n                        <InputGroup.Append\n                            style={\n                                !changed\n                                    ? {\n                                          opacity: 0,\n                                          pointerEvents: \"none\"\n                                      }\n                                    : {}\n                            }\n                            onClick={() => {\n                                this.setState({\n                                    currentValue: this.props.defaultValue\n                                });\n                            }}>\n                            <InputGroup.Text>\n                                <FontAwesomeIcon fixedWidth icon=\"undo\" />\n                            </InputGroup.Text>\n                        </InputGroup.Append>\n                        <InputGroup.Append\n                            style={\n                                !changed\n                                    ? {\n                                          opacity: 0,\n                                          pointerEvents: \"none\"\n                                      }\n                                    : {}\n                            }\n                            onClick={() => {\n                                switch (this.props.type) {\n                                    case \"str\":\n                                        this.props.onChange(this.state.currentValue as string);\n                                        break;\n                                    case \"num\":\n                                        this.props.onChange(this.state.currentValue as number);\n                                        break;\n                                    case \"bool\":\n                                        this.props.onChange(this.state.currentValue as boolean);\n                                        break;\n                                    case \"enum\":\n                                        this.props.onChange(this.state.currentValue as string);\n                                        break;\n                                }\n                            }}>\n                            <InputGroup.Text>\n                                <FontAwesomeIcon fixedWidth icon=\"check\" />\n                            </InputGroup.Text>\n                        </InputGroup.Append>\n                    </React.Fragment>\n                </div>\n            </InputGroup>\n        );\n    }\n}\n","import React from \"react\";\nimport { RouteComponentProps, withRouter } from \"react-router-dom\";\n\nimport {\n    ConfigurationType,\n    InstanceManagerRights\n} from \"../../../../ApiClient/generatedcode/_enums\";\nimport { Components } from \"../../../../ApiClient/generatedcode/_generated\";\nimport InstanceClient from \"../../../../ApiClient/InstanceClient\";\nimport InternalError, { ErrorCode } from \"../../../../ApiClient/models/InternalComms/InternalError\";\nimport { StatusCode } from \"../../../../ApiClient/models/InternalComms/InternalStatus\";\nimport { RequireAtLeastOne } from \"../../../../ApiClient/ServerClient\";\nimport ErrorAlert from \"../../../utils/ErrorAlert\";\nimport InputField from \"../../../utils/InputField\";\nimport Loading from \"../../../utils/Loading\";\n\ninterface IProps extends RouteComponentProps {\n    instance: Components.Schemas.Instance;\n    loadInstance: () => unknown;\n    selfPermissionSet: Components.Schemas.PermissionSet;\n}\ninterface IState {\n    errors: Array<InternalError<ErrorCode> | undefined>;\n    loading: boolean;\n}\n\nexport default withRouter(\n    class InstanceSettings extends React.Component<IProps, IState> {\n        public constructor(props: IProps) {\n            super(props);\n\n            this.state = {\n                loading: false,\n                errors: []\n            };\n        }\n\n        private addError(error: InternalError<ErrorCode>): void {\n            this.setState(prevState => {\n                const errors = Array.from(prevState.errors);\n                errors.push(error);\n                return {\n                    errors\n                };\n            });\n        }\n\n        private async _editInstance(instance: RequireAtLeastOne<Components.Schemas.Instance>) {\n            const response = await InstanceClient.editInstance({\n                ...instance,\n                id: this.props.instance.id\n            });\n            if (response.code === StatusCode.OK) {\n                this.setState({\n                    loading: true\n                });\n                await this.props.loadInstance();\n                this.setState({\n                    loading: false\n                });\n            } else {\n                this.addError(response.error);\n            }\n        }\n\n        private editInstance(instance: RequireAtLeastOne<Components.Schemas.Instance>) {\n            void this._editInstance(instance);\n        }\n\n        public render(): React.ReactNode {\n            if (this.state.loading) {\n                return <Loading text=\"loading.instance\" />;\n            }\n\n            const checkIMFlag = (flag: InstanceManagerRights) => {\n                return this.props.selfPermissionSet.instanceManagerRights! & flag;\n            };\n\n            return (\n                <div className=\"text-center\">\n                    {this.state.errors.map((err, index) => {\n                        if (!err) return;\n                        return (\n                            <ErrorAlert\n                                key={index}\n                                error={err}\n                                onClose={() =>\n                                    this.setState(prev => {\n                                        const newarr = Array.from(prev.errors);\n                                        newarr[index] = undefined;\n                                        return {\n                                            errors: newarr\n                                        };\n                                    })\n                                }\n                            />\n                        );\n                    })}\n\n                    <InputField\n                        name=\"instance.name\"\n                        defaultValue={this.props.instance.name}\n                        type=\"str\"\n                        onChange={newval => {\n                            this.editInstance({ name: newval });\n                        }}\n                        disabled={!checkIMFlag(InstanceManagerRights.Rename)}\n                    />\n                    <InputField\n                        name=\"instance.path\"\n                        defaultValue={this.props.instance.path}\n                        type=\"str\"\n                        onChange={newval => {\n                            this.editInstance({ path: newval });\n                        }}\n                        disabled={!checkIMFlag(InstanceManagerRights.Relocate)}\n                    />\n                    <InputField\n                        name=\"instance.chatbotlimit\"\n                        defaultValue={this.props.instance.chatBotLimit!}\n                        type=\"num\"\n                        onChange={newval => {\n                            this.editInstance({ chatBotLimit: newval });\n                        }}\n                        disabled={!checkIMFlag(InstanceManagerRights.SetChatBotLimit)}\n                    />\n                    <InputField\n                        name=\"instance.autoupdate\"\n                        defaultValue={this.props.instance.autoUpdateInterval!}\n                        type=\"num\"\n                        onChange={newval => {\n                            this.editInstance({\n                                autoUpdateInterval: newval\n                            });\n                        }}\n                        disabled={!checkIMFlag(InstanceManagerRights.SetAutoUpdate)}\n                    />\n                    <InputField\n                        name=\"instance.filemode\"\n                        defaultValue={ConfigurationType[this.props.instance.configurationType!]}\n                        type=\"enum\"\n                        enum={ConfigurationType}\n                        onChange={newval => {\n                            this.editInstance({\n                                // @ts-expect-error typescript isnt a fan of using enums like this\n                                configurationType: ConfigurationType[newval] as 0 | 1 | 2\n                            });\n                        }}\n                        disabled={!checkIMFlag(InstanceManagerRights.SetConfiguration)}\n                    />\n                </div>\n            );\n        }\n    }\n);\n"],"sourceRoot":""}